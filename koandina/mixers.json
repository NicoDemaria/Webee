{
    "aggregate": [
        {
            "$match": {
                "$and": [
                    {
                        "deviceId": {
                            "$oid": "630174e8ed085d00115a2b46"
                        }
                    },
                    {
                        "createdAt": {
                            "$gte": {
                                "$date": "2022-08-23T13:26:19.885Z"
                            }
                        }
                    }
                ]
            }
        },
        {
            "$sort": {
                "createdAt": -1
            }
        },
        {
            "$project": {
                "_id": 0,
                "deviceName": 1,
                "deviceId": 1,
                "createdAt": 1,
                "totalMixer1": {
                    "$ifNull": [
                        "$Mixer_L1_Total",
                        "-"
                    ]
                },
                "pulseMixer1": {
                    "$ifNull": [
                        "$Mixer_L1_Pulso",
                        "-"
                    ]
                },
                "totalMixer2": {
                    "$ifNull": [
                        "$Mixer_L2_Total",
                        "-"
                    ]
                },
                "pulseMixer2": {
                    "$ifNull": [
                        "$Mixer_L2_Pulso",
                        "-"
                    ]
                },
                "totalMixer3": {
                    "$ifNull": [
                        "$Mixer_L3_Total",
                        "-"
                    ]
                },
                "pulseMixer3": {
                    "$ifNull": [
                        "$Mixer_L3_Pulso",
                        "-"
                    ]
                },
                "totalMixer4": {
                    "$ifNull": [
                        "$Mixer_L4_Total",
                        "-"
                    ]
                },
                "pulseMixer4": {
                    "$ifNull": [
                        "$Mixer_L4_Pulso",
                        "-"
                    ]
                },
                "totalMixer5": {
                    "$ifNull": [
                        "$Mixer_L5_Total",
                        "-"
                    ]
                },
                "pulseMixer5": {
                    "$ifNull": [
                        "$Mixer_L5_Pulso",
                        "-"
                    ]
                },
                "totalMixer6": {
                    "$ifNull": [
                        "$Mixer_L6_Total",
                        "-"
                    ]
                },
                "pulseMixer6": {
                    "$ifNull": [
                        "$Mixer_L6_Pulso",
                        "-"
                    ]
                },
                "timezone2": {
                    "$dateToParts": {
                        "date": "$createdAt",
                        "timezone": "America/Asuncion"
                    }
                }
            }
        },
        {
            "$addFields": {
                "timezone": {
                    "$dateFromParts": {
                        "year": "$timezone2.year",
                        "month": "$timezone2.month",
                        "day": "$timezone2.day",
                        "hour": "$timezone2.hour",
                        "minute": "$timezone2.minute"
                    }
                }
            }
        },
        {
            "$sort": {
                "createdAt": -1
            }
        },
        {
            "$facet": {
                "caudalVol": [
                    {
                        "$group": {
                            "_id": {
                                "date": {
                                    "$dateFromParts": {
                                        "year": {
                                            "$year": "$timezone"
                                        },
                                        "month": {
                                            "$month": "$timezone"
                                        },
                                        "day": {
                                            "$dayOfMonth": "$timezone"
                                        },
                                        "hour": {
                                            "$hour": "$timezone"
                                        }
                                    }
                                }
                            },
                            "totalMixer1": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$ne": [
                                                "$totalMixer1",
                                                "-"
                                            ]
                                        },
                                        "then": {
                                            "name": "$createdAt",
                                            "value": "$totalMixer1"
                                        },
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "totalMixer2": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$ne": [
                                                "$totalMixer2",
                                                "-"
                                            ]
                                        },
                                        "then": "$totalMixer2",
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "totalMixer3": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$ne": [
                                                "$totalMixer3",
                                                "-"
                                            ]
                                        },
                                        "then": "$totalMixer3",
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "totalMixer4": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$ne": [
                                                "$totalMixer4",
                                                "-"
                                            ]
                                        },
                                        "then": "$totalMixer4",
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "totalMixer5": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$ne": [
                                                "$totalMixer5",
                                                "-"
                                            ]
                                        },
                                        "then": "$totalMixer5",
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "totalMixer6": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$ne": [
                                                "$totalMixer6",
                                                "-"
                                            ]
                                        },
                                        "then": "$totalMixer6",
                                        "else": "$$REMOVE"
                                    }
                                }
                            }
                        }
                    },
                    {
                        "$set": {
                            "totalMixer1": {
                                "$subtract": [
                                    {
                                        "$arrayElemAt": [
                                            "$totalMixer1.value",
                                            0
                                        ]
                                    },
                                    {
                                        "$arrayElemAt": [
                                            "$totalMixer1.value",
                                            3
                                        ]
                                    }
                                ]
                            },
                            "totalMixer2": {
                                "$subtract": [
                                    {
                                        "$arrayElemAt": [
                                            "$totalMixer2",
                                            0
                                        ]
                                    },
                                    {
                                        "$arrayElemAt": [
                                            "$totalMixer2",
                                            3
                                        ]
                                    }
                                ]
                            },
                            "totalMixer3": {
                                "$subtract": [
                                    {
                                        "$arrayElemAt": [
                                            "$totalMixer3",
                                            0
                                        ]
                                    },
                                    {
                                        "$arrayElemAt": [
                                            "$totalMixer3",
                                            3
                                        ]
                                    }
                                ]
                            },
                            "totalMixer4": {
                                "$subtract": [
                                    {
                                        "$arrayElemAt": [
                                            "$totalMixer4",
                                            0
                                        ]
                                    },
                                    {
                                        "$arrayElemAt": [
                                            "$totalMixer4",
                                            3
                                        ]
                                    }
                                ]
                            },
                            "totalMixer5": {
                                "$subtract": [
                                    {
                                        "$arrayElemAt": [
                                            "$totalMixer5",
                                            0
                                        ]
                                    },
                                    {
                                        "$arrayElemAt": [
                                            "$totalMixer5",
                                            3
                                        ]
                                    }
                                ]
                            },
                            "totalMixer6": {
                                "$subtract": [
                                    {
                                        "$arrayElemAt": [
                                            "$totalMixer6",
                                            0
                                        ]
                                    },
                                    {
                                        "$arrayElemAt": [
                                            "$totalMixer6",
                                            3
                                        ]
                                    }
                                ]
                            },
                            "fin": {
                                "$arrayElemAt": [
                                    "$totalMixer1.name",
                                    0
                                ]
                            },
                            "inicio": {
                                "$arrayElemAt": [
                                    "$totalMixer1.name",
                                    3
                                ]
                            }
                        }
                    },
                    {
                        "$sort": {
                            "_id.date": -1
                        }
                    },
                    {
                        "$limit": 1
                    }
                ],
                "currDay": [
                    {
                        "$group": {
                            "_id": {
                                "$dateFromParts": {
                                    "year": {
                                        "$year": "$timezone"
                                    },
                                    "month": {
                                        "$month": "$timezone"
                                    },
                                    "day": {
                                        "$dayOfMonth": "$timezone"
                                    }
                                }
                            },
                            "pulseMixer1": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$and": [
                                                {
                                                    "$ne": [
                                                        "$pulseMixer1",
                                                        "-"
                                                    ]
                                                }
                                            ]
                                        },
                                        "then": {
                                            "name": "$createdAt",
                                            "value": "$pulseMixer1"
                                        },
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "pulseMixer2": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$and": [
                                                {
                                                    "$ne": [
                                                        "$pulseMixer2",
                                                        "-"
                                                    ]
                                                }
                                            ]
                                        },
                                        "then": {
                                            "name": "$createdAt",
                                            "value": "$pulseMixer2"
                                        },
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "pulseMixer3": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$and": [
                                                {
                                                    "$ne": [
                                                        "$pulseMixer3",
                                                        "-"
                                                    ]
                                                }
                                            ]
                                        },
                                        "then": {
                                            "name": "$createdAt",
                                            "value": "$pulseMixer3"
                                        },
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "pulseMixer4": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$and": [
                                                {
                                                    "$ne": [
                                                        "$pulseMixer4",
                                                        "-"
                                                    ]
                                                }
                                            ]
                                        },
                                        "then": {
                                            "name": "$createdAt",
                                            "value": "$pulseMixer4"
                                        },
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "pulseMixer5": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$and": [
                                                {
                                                    "$ne": [
                                                        "$pulseMixer5",
                                                        "-"
                                                    ]
                                                }
                                            ]
                                        },
                                        "then": {
                                            "name": "$createdAt",
                                            "value": "$pulseMixer5"
                                        },
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "pulseMixer6": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$and": [
                                                {
                                                    "$ne": [
                                                        "$pulseMixer6",
                                                        "-"
                                                    ]
                                                }
                                            ]
                                        },
                                        "then": {
                                            "name": "$createdAt",
                                            "value": "$pulseMixer6"
                                        },
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "totalMixer1": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$ne": [
                                                "$totalMixer1",
                                                "-"
                                            ]
                                        },
                                        "then": "$totalMixer1",
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "totalMixer2": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$ne": [
                                                "$totalMixer2",
                                                "-"
                                            ]
                                        },
                                        "then": "$totalMixer2",
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "totalMixer3": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$ne": [
                                                "$totalMixer3",
                                                "-"
                                            ]
                                        },
                                        "then": "$totalMixer3",
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "totalMixer4": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$ne": [
                                                "$totalMixer4",
                                                "-"
                                            ]
                                        },
                                        "then": "$totalMixer4",
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "totalMixer5": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$ne": [
                                                "$totalMixer5",
                                                "-"
                                            ]
                                        },
                                        "then": "$totalMixer5",
                                        "else": "$$REMOVE"
                                    }
                                }
                            },
                            "totalMixer6": {
                                "$push": {
                                    "$cond": {
                                        "if": {
                                            "$ne": [
                                                "$totalMixer6",
                                                "-"
                                            ]
                                        },
                                        "then": "$totalMixer6",
                                        "else": "$$REMOVE"
                                    }
                                }
                            }
                        }
                    },
                    {
                        "$facet": {
                            "caudalVol": [
                                {
                                    "$group": {
                                        "_id": {
                                            "deviceId": "$deviceId",
                                            "date": {
                                                "$dateFromParts": {
                                                    "year": {
                                                        "$year": "$timezone"
                                                    },
                                                    "month": {
                                                        "$month": "$timezone"
                                                    },
                                                    "day": {
                                                        "$dayOfMonth": "$timezone"
                                                    },
                                                    "hour": {
                                                        "$hour": "$timezone"
                                                    }
                                                }
                                            }
                                        },
                                        "totalWell3": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell3",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell3"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell5": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell5",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell5"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell7": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell7",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell7"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell8": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell8",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell8"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell9": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell9",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell9"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell10": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell10",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell10"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell11": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell11",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell11"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell12": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell12",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell12"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    "$set": {
                                        "totalWell3": {
                                            "$subtract": [
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell3.value",
                                                        0
                                                    ]
                                                },
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell3.value",
                                                        3
                                                    ]
                                                }
                                            ]
                                        },
                                        "totalWell5": {
                                            "$subtract": [
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell5.value",
                                                        0
                                                    ]
                                                },
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell5.value",
                                                        3
                                                    ]
                                                }
                                            ]
                                        },
                                        "totalWell7": {
                                            "$subtract": [
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell7.value",
                                                        0
                                                    ]
                                                },
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell7.value",
                                                        3
                                                    ]
                                                }
                                            ]
                                        },
                                        "totalWell8": {
                                            "$subtract": [
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell8.value",
                                                        0
                                                    ]
                                                },
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell8.value",
                                                        3
                                                    ]
                                                }
                                            ]
                                        },
                                        "totalWell9": {
                                            "$subtract": [
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell9.value",
                                                        0
                                                    ]
                                                },
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell9.value",
                                                        3
                                                    ]
                                                }
                                            ]
                                        },
                                        "totalWell10": {
                                            "$subtract": [
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell10.value",
                                                        0
                                                    ]
                                                },
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell10.value",
                                                        3
                                                    ]
                                                }
                                            ]
                                        },
                                        "totalWell11": {
                                            "$subtract": [
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell11.value",
                                                        0
                                                    ]
                                                },
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell11.value",
                                                        3
                                                    ]
                                                }
                                            ]
                                        },
                                        "totalWell12": {
                                            "$subtract": [
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell12.value",
                                                        0
                                                    ]
                                                },
                                                {
                                                    "$arrayElemAt": [
                                                        "$totalWell12.value",
                                                        3
                                                    ]
                                                }
                                            ]
                                        },
                                        "fin": {
                                            "$arrayElemAt": [
                                                "$totalWell3.name",
                                                0
                                            ]
                                        },
                                        "inicio": {
                                            "$arrayElemAt": [
                                                "$totalWell3.name",
                                                3
                                            ]
                                        }
                                    }
                                },
                                {
                                    "$sort": {
                                        "_id.date": -1
                                    }
                                },
                                {
                                    "$limit": 1
                                }
                            ],
                            "currDay": [
                                {
                                    "$group": {
                                        "_id": {
                                            "$dateFromParts": {
                                                "year": {
                                                    "$year": "$timezone"
                                                },
                                                "month": {
                                                    "$month": "$timezone"
                                                },
                                                "day": {
                                                    "$dayOfMonth": "$timezone"
                                                }
                                            }
                                        },
                                        "totalWell3": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell3",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell3"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "pulseWell3": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$and": [
                                                            {
                                                                "$ne": [
                                                                    "$pulseWell3",
                                                                    "-"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$pulseWell3"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell5": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell5",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell5"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "pulseWell5": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$and": [
                                                            {
                                                                "$ne": [
                                                                    "$pulseWell5",
                                                                    "-"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$pulseWell5"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell7": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell7",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell7"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "pulseWell7": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$and": [
                                                            {
                                                                "$ne": [
                                                                    "$pulseWell7",
                                                                    "-"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$pulseWell7"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell8": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell8",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell8"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "pulseWell8": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$and": [
                                                            {
                                                                "$ne": [
                                                                    "$pulseWell8",
                                                                    "-"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$pulseWell8"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell9": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell9",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell9"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "pulseWell9": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$and": [
                                                            {
                                                                "$ne": [
                                                                    "$pulseWell9",
                                                                    "-"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$pulseWell9"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell10": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell10",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell10"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "pulseWell10": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$and": [
                                                            {
                                                                "$ne": [
                                                                    "$pulseWell10",
                                                                    "-"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$pulseWell10"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell11": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell11",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell11"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "pulseWell11": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$and": [
                                                            {
                                                                "$ne": [
                                                                    "$pulseWell11",
                                                                    "-"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$pulseWell11"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "totalWell12": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$ne": [
                                                            "$totalWell12",
                                                            "-"
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$totalWell12"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        },
                                        "pulseWell12": {
                                            "$push": {
                                                "$cond": {
                                                    "if": {
                                                        "$and": [
                                                            {
                                                                "$ne": [
                                                                    "$pulseWell12",
                                                                    "-"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "then": {
                                                        "name": "$createdAt",
                                                        "value": "$pulseWell12"
                                                    },
                                                    "else": "$$REMOVE"
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    "$set": {
                                        "totalWell3": {
                                            "$subtract": [
                                                {
                                                    "$first": "$totalWell3.value"
                                                },
                                                {
                                                    "$last": "$totalWell3.value"
                                                }
                                            ]
                                        },
                                        "totalWell5": {
                                            "$subtract": [
                                                {
                                                    "$first": "$totalWell5.value"
                                                },
                                                {
                                                    "$last": "$totalWell5.value"
                                                }
                                            ]
                                        },
                                        "totalWell7": {
                                            "$subtract": [
                                                {
                                                    "$first": "$totalWell7.value"
                                                },
                                                {
                                                    "$last": "$totalWell7.value"
                                                }
                                            ]
                                        },
                                        "totalWell8": {
                                            "$subtract": [
                                                {
                                                    "$first": "$totalWell8.value"
                                                },
                                                {
                                                    "$last": "$totalWell8.value"
                                                }
                                            ]
                                        },
                                        "totalWell9": {
                                            "$subtract": [
                                                {
                                                    "$first": "$totalWell9.value"
                                                },
                                                {
                                                    "$last": "$totalWell9.value"
                                                }
                                            ]
                                        },
                                        "totalWell10": {
                                            "$subtract": [
                                                {
                                                    "$first": "$totalWell10.value"
                                                },
                                                {
                                                    "$last": "$totalWell10.value"
                                                }
                                            ]
                                        },
                                        "totalWell11": {
                                            "$subtract": [
                                                {
                                                    "$first": "$totalWell11.value"
                                                },
                                                {
                                                    "$last": "$totalWell11.value"
                                                }
                                            ]
                                        },
                                        "totalWell12": {
                                            "$subtract": [
                                                {
                                                    "$first": "$totalWell12.value"
                                                },
                                                {
                                                    "$last": "$totalWell12.value"
                                                }
                                            ]
                                        },
                                        "pulseWell3": {
                                            "$first": "$pulseWell3"
                                        },
                                        "pulseWell5": {
                                            "$first": "$pulseWell5"
                                        },
                                        "pulseWell7": {
                                            "$first": "$pulseWell7"
                                        },
                                        "pulseWell8": {
                                            "$first": "$pulseWell8"
                                        },
                                        "pulseWell9": {
                                            "$first": "$pulseWell9"
                                        },
                                        "pulseWell10": {
                                            "$first": "$pulseWell10"
                                        },
                                        "pulseWell11": {
                                            "$first": "$pulseWell11"
                                        },
                                        "pulseWell12": {
                                            "$first": "$pulseWell12"
                                        }
                                    }
                                }
                            ],
                            "alertTypes": [
                                {
                                    "$limit": 1
                                },
                                {
                                    "$lookup": {
                                        "from": "FormLog",
                                        "let": {},
                                        "pipeline": [
                                            {
                                                "$match": {
                                                    "$and": [
                                                        {
                                                            "enterpriseId": {
                                                                "$oid": "619d3a500f578700128c30a1"
                                                            }
                                                        },
                                                        {
                                                            "collectionName": "alertTypes2"
                                                        },
                                                        {
                                                            "deletedAt": {
                                                                "$exists": false
                                                            }
                                                        },
                                                        {
                                                            "data": {
                                                                "$exists": true
                                                            }
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "$project": {
                                                    "_id": 0,
                                                    "data": 1
                                                }
                                            }
                                        ],
                                        "as": "arr"
                                    }
                                },
                                {
                                    "$project": {
                                        "_id": 0,
                                        "arr": 1
                                    }
                                }
                            ],
                            "assets": [
                                {
                                    "$limit": 1
                                },
                                {
                                    "$lookup": {
                                        "from": "FormLog",
                                        "let": {},
                                        "pipeline": [
                                            {
                                                "$match": {
                                                    "$and": [
                                                        {
                                                            "enterpriseId": {
                                                                "$oid": "619d3a500f578700128c30a1"
                                                            }
                                                        },
                                                        {
                                                            "collectionName": "waterAssets"
                                                        },
                                                        {
                                                            "deletedAt": {
                                                                "$exists": false
                                                            }
                                                        },
                                                        {
                                                            "data": {
                                                                "$exists": true
                                                            }
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "$project": {
                                                    "_id": 0,
                                                    "data": 1
                                                }
                                            }
                                        ],
                                        "as": "arr"
                                    }
                                },
                                {
                                    "$project": {
                                        "_id": 0,
                                        "arr": 1
                                    }
                                }
                            ]
                        }
                    }
                ]
            }
        }
    ]
}